<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - Food Buddies</title>
    <link rel="stylesheet" href="Events.css">
</head>
<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <a href="../home/home.html"><button>Home</button></a>
            <a href="../maps/maps.html"><button>Maps</button></a>
            <a href="../events/Events.html"><button class="active">Events</button></a>
            <a href="../messages/Messages.html"><button>Messages</button></a>
            <a href="../profile/Profile.html"><button>Profile</button></a>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <!-- Search Section -->
        <div class="search-section">
            <div class="search-bar">
                <span class="filter-icon">â˜°</span>
                <input type="text" id="searchInput" placeholder="Search an event...">
                <span class="search-icon">ğŸ”</span>
            </div>
            <div class="red-panda">
                <img src="Red Panda.png" alt="Red Panda">
            </div>
        </div>

        <!-- Happening Today Section -->
        <div class="events-section">
            <h2>Happening Today</h2>
            <div class="carousel-container">
                <div class="carousel" id="todayCarousel">
                    <!-- Events will be dynamically added here -->
                </div>
            </div>
        </div>

        <!-- Future Events Section -->
        <div class="events-section future-section">
            <div class="section-header">
                <h2>Future Events</h2>
                <button class="plan-visit-btn">Plan a Visit</button>
            </div>
            <div class="carousel-container">
                <div class="carousel" id="futureCarousel">
                    <!-- Events will be dynamically added here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Event Details Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <span class="close-btn" id="closeModal">&times;</span>
            <img id="modalImage" src="" alt="Event">
            <h2 id="modalTitle"></h2>
            <div class="modal-details">
                <p><strong>ğŸ“… Date:</strong> <span id="modalDate"></span></p>
                <p><strong>ğŸ• Time:</strong> <span id="modalTime"></span></p>
                <p><strong>ğŸ“ Location:</strong> <span id="modalLocation"></span></p>
            </div>
        </div>
    </div>

    <script>
        // Event data
        const todayEvents = [
            { name: "BigWay", time: "9:00 PM", image: "Hotpot.png", date: "Today", location: "Big Way Hot Pot - UBC" },
            { name: "Chipotle", time: "3:00 PM", image: "Burrito.png", date: "Today", location: "Chipotle - UBC Village" },
            { name: "Uncle Fatih's", time: "6:00 PM", image: "Pizza.png", date: "Today", location: "Uncle Fatih's Pizza - UBC" },
            { name: "Kinton Ramen", time: "10:00 PM", image: "Ramen.png", date: "Today", location: "Kinton Ramen - UBC" },
            { name: "Blue Chip", time: "2:00 PM", image: "Cookies.png", date: "Today", location: "Blue Chip Cookies - UBC" }
        ];

        const futureEvents = [
            { name: "McDonald's", time: "Tomorrow", image: ["Burger.png", "Fries.png"], date: "Nov 17, 2025", location: "McDonald's - UBC" },
            { name: "Browns Crafthouse", time: "Nov 18", image: ["Steak.png", "Martini.png"], date: "Nov 18, 2025", location: "Browns Social House - UBC" },
            { name: "Steve's PokÃ©", time: "Nov 19", image: "PokeBowl.png", date: "Nov 19, 2025", location: "Steve's PokÃ© Bar - UBC" }
        ];

        let todayScrollInterval;
        let futureScrollInterval;
        let todayPaused = false;
        let futurePaused = false;

        // Render events
        function renderEvents(events, carouselId) {
            const carousel = document.getElementById(carouselId);
            carousel.innerHTML = '';

            // Duplicate events for infinite scroll effect
            const extendedEvents = [...events, ...events, ...events];

            extendedEvents.forEach((event, index) => {
                const card = document.createElement('div');
                card.className = 'event-card';
                card.dataset.originalIndex = index % events.length;

                const imageContainer = document.createElement('div');
                imageContainer.className = 'event-image';

                if (Array.isArray(event.image)) {
                    // Multiple images
                    event.image.forEach(img => {
                        const imgElement = document.createElement('img');
                        imgElement.src = img;
                        imgElement.alt = event.name;
                        imageContainer.appendChild(imgElement);
                    });
                } else {
                    // Single image
                    const imgElement = document.createElement('img');
                    imgElement.src = event.image;
                    imgElement.alt = event.name;
                    imageContainer.appendChild(imgElement);
                }

                const eventInfo = document.createElement('div');
                eventInfo.className = 'event-info';
                eventInfo.innerHTML = `
                    <h3>${event.name}</h3>
                    <p>${event.time}</p>
                `;

                card.appendChild(imageContainer);
                card.appendChild(eventInfo);

                // Click event to show modal
                card.addEventListener('click', () => {
                    showModal(events[event.originalIndex || index % events.length]);
                });

                // Pause on hover
                card.addEventListener('mouseenter', () => {
                    if (carouselId === 'todayCarousel') {
                        todayPaused = true;
                    } else {
                        futurePaused = true;
                    }
                });

                card.addEventListener('mouseleave', () => {
                    if (carouselId === 'todayCarousel') {
                        todayPaused = false;
                    } else {
                        futurePaused = false;
                    }
                });

                carousel.appendChild(card);
            });
        }

        // Auto-scroll function
        function startAutoScroll(carouselId, isPausedFlag) {
            const carousel = document.getElementById(carouselId);
            let scrollAmount = 0;

            const interval = setInterval(() => {
                if ((carouselId === 'todayCarousel' && todayPaused) || 
                    (carouselId === 'futureCarousel' && futurePaused)) {
                    return;
                }

                scrollAmount += 0.5; // Slow and smooth
                carousel.scrollLeft = scrollAmount;

                // Reset scroll for infinite effect
                const maxScroll = carousel.scrollWidth / 3;
                if (scrollAmount >= maxScroll) {
                    scrollAmount = 0;
                    carousel.scrollLeft = 0;
                }
            }, 20);

            if (carouselId === 'todayCarousel') {
                todayScrollInterval = interval;
            } else {
                futureScrollInterval = interval;
            }
        }

        // Show modal
        function showModal(event) {
            const modal = document.getElementById('eventModal');
            document.getElementById('modalTitle').textContent = event.name;
            document.getElementById('modalDate').textContent = event.date;
            document.getElementById('modalTime').textContent = event.time;
            document.getElementById('modalLocation').textContent = event.location;

            // Set image
            const modalImage = document.getElementById('modalImage');
            if (Array.isArray(event.image)) {
                modalImage.src = event.image[0]; // Show first image
            } else {
                modalImage.src = event.image;
            }

            modal.classList.add('active');
        }

        // Close modal
        document.getElementById('closeModal').addEventListener('click', () => {
            document.getElementById('eventModal').classList.remove('active');
        });

        // Close modal when clicking outside
        document.getElementById('eventModal').addEventListener('click', (e) => {
            if (e.target.id === 'eventModal') {
                document.getElementById('eventModal').classList.remove('active');
            }
        });

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            
            const allCards = document.querySelectorAll('.event-card');
            allCards.forEach(card => {
                const eventName = card.querySelector('h3').textContent.toLowerCase();
                if (eventName.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        });

        // Initialize
        renderEvents(todayEvents, 'todayCarousel');
        renderEvents(futureEvents, 'futureCarousel');
        startAutoScroll('todayCarousel');
        startAutoScroll('futureCarousel');
    </script>
</body>
</html>